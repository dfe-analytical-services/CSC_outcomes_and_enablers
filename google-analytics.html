<script>
// Define dataLayer and the gtag function.
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

// Default ad_storage to 'denied' as a placeholder
// Determine actual values based on your own requirements
gtag('consent', 'default', {
  'ad_storage': 'denied',
  'analytics_storage': 'denied'
});
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q13T4ENF6C"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}

    gtag('js', new Date());
    
/*
The tracking number below MUST be replaced with a unique number, contact the statistics development team to set this up. 
*/
  gtag('config', 'G-Q13T4ENF6C');
  
// This handles tracking the top level choices menu via the active navlistPanel
  $(document).on('click', 'ul#navlistPanel', function(e) {
    gtag('event', 'navlistPanel', {'event_category' : 'navbar click',
    'event_label' : document.querySelector(
      'ul#navlistPanel > li.nav-item > a.nav-link.active'
    ).getAttribute('data-value')
    });
  });

  $(document).on('shiny:disconnected', function(e) {
    gtag('event', 'disconnect', { 
      'event_label' : 'Disconnect',
      'event_category' : 'Disconnect'
    });
  });

/* Adding in custom google analytics tracking for the domain tabs */

  $(document).on('click', 'ul.nav-tabs a.active', function(e) {
    gtag(
      'event', 
      'Tab selection', 
      {
        'event_category' : 'Tab selection', 
        'event_label' : e.currentTarget['innerText']
      }
    );
  });
  
  
/*
Adding in custom google analytics tracking for the Accordian selections
*/

  $(document).on('click', '.accordion-button', function(e) {
    gtag(
      'event', 
      'Accordion', 
      {
        'event_category' : 'Accordion', 
        'event_label' : e.currentTarget['innerText']
      }
    );
  });
  
/*  Adding in custom google analytics tracking for the geographic  selections */

$(document).on('change', 'select', function(e) {
      var selectedValue = $(this).val();
      var selectedId = $(this).attr("id");
      
      if (selectedId.startsWith("geographic_breakdown_")) {
          console.log('Selected value:', selectedValue);
          console.log('Selected id:', selectedId);
      
          gtag(
            'event', 
            'Dropdown: Geo-select', 
          {
            'event_category' : selectedId, 
            'event_label' : selectedValue 
          });
      }
    });

/*  Adding in custom google analytics tracking for the Non-geographic  selections */    

$(document).on('change', 'select', function(e) {
      var selectedValue = $(this).val();
      var selectedId = $(this).attr("id");
      
      if (selectedId == "wellbeing_extra_breakdown" || 
          selectedId == "wellbeing_school_breakdown" || 
          selectedId == "attainment_extra_breakdown" ||
          selectedId == "assessment_factors_1" ||
          selectedId == "assessment_factors_2" ||
          selectedId == "placement_type_breakdown" ||
          selectedId == "select_age_group_o4" ||
          selectedId == "leavers_age") {
            
          console.log('Selected value:', selectedValue);
          console.log('Selected id:', selectedId);
      
         
          gtag(
            'event', 
            'Dropdown: Non-geographic', 
          {
            'event_category' : selectedId, 
            'event_label' : selectedValue
          }
    );
      // You can add more actions here
  
      }
    });
  
</script>
      

