outcome2_tab <- function() {
  tabPanel(
    value = "outcome2_page",
    "Outcome 2",
    gov_main_layout(
      gov_row(
        column(
          width = 12,
          h1("Outcome 2: Children and young people are supported by their family network")
        )
      ),
      gov_row(
        div(
          class = "input_box",
          style = "min-height:100%; height = 100%; overflow-y: visible",
          layout_columns(
            selectizeInput(
              inputId = "select_geography_o2",
              label = "Select a geographical level:",
              choices = unique(workforce_data %>% pull("geographic_level")),
              selected = NULL,
              multiple = FALSE,
              options = NULL
            ),
            conditionalPanel(
              condition = "input.select_geography_o2 != 'National'",
              selectizeInput(
                inputId = "geographic_breakdown_o2",
                label = "Select a location: ",
                choices = NULL,
                selected = NULL,
                multiple = FALSE,
                options = NULL
              )
            ),
            col_widths = c(4, 8)
          ),
          layout_columns(
            conditionalPanel(
              condition = "input.select_geography_o2 != 'National'",
              column(
                width = 3,
                checkbox_Input(
                  inputId = "national_comparison_checkbox_o2",
                  cb_labels = "Compare with National",
                  checkboxIds = "Yes_national",
                  label = "",
                  hint_label = NULL,
                  small = TRUE
                )
              )
            ),
            conditionalPanel(
              condition = "(input.select_geography_o2 == 'Local authority')",
              column(
                width = 3,
                checkbox_Input(
                  inputId = "region_comparison_checkbox_o2",
                  cb_labels = "Compare with Region",
                  checkboxIds = "Yes_region",
                  label = "",
                  hint_label = NULL,
                  small = TRUE
                )
              )
            ),
            col_widths = c(4, 8)
          )
        )
      ),
      # gov_row(
      #   div(
      #     class = "input_box",
      #     style = "min-height:100%; height = 100%; overflow-y: visible",
      #     gov_row(
      #       column(
      #         width = 6,
      #         h2("Inputs go here")
      #       ),
      #       column(
      #         width = 6,
      #         h2("Inputs go here")
      #       )
      #     )
      #   )
      # ),
      br(),
      gov_row(
        br(),
        p(htmlOutput("outcome2_choice_text1"), htmlOutput("outcome2_choice_text2")),
        conditionalPanel(
          condition = "(input.geographic_breakdown_o2 == 'Cumbria')",
          p("Cumbria are still in the latest statistics because they relate to the year ending 31 March 2023. Cumbria local authority was replaced with two new unitary authorities, Cumberland and Westmorland and Furness, in April 2023.")
        ),
      ),
      gov_row(
        br(),
        div(
          tabsetPanel(
            id = "outcome2_panels",
            type = "tabs",
            tabPanel(
              "Families engaging and receiving support from their family network",
              fluidRow(
                br()
              ),
              fluidRow(
                column(
                  width = 6,
                  value_box(
                    title = "Percentage of children who cease being looked after due to Special Guardianship Order (SGO)",
                    value = htmlOutput("SGO_headline_txt")
                  )
                ),
                column(
                  width = 6,
                  value_box(
                    title = "Percentage of children who cease being looked after due to Residence order or Child Arrangement Order (CAO)",
                    value = htmlOutput("CAO_headline_txt")
                  )
                ),
                br(),
                p("Unlocking family networks and kinship carers can be a key source of support where families are experiencing challenges.
                  Moving children from care arrangements to a SGO or CAO shows that kinship care is being prioritised where children cannot safely live with their parents.")
              ),
              accordion(
                accordion_panel(
                  "Percentage of children who cease being looked after due to Special Guardianship Order (SGO)",
                  gov_row(
                    h2("Special Guardianship Order (SGO)"),
                    # p("Unlocking family networks and kinship carers can be a key source of support where families are experiencing challenges.
                    # Moving children from care arrangements to a SGO or CAO shows that kinship care is being prioritised where children cannot safely live with their parents."),
                    br(),
                    plotlyOutput("SGO_time_series"),
                    br(),
                    details(
                      inputId = "tbl_sgo_ceased_cla",
                      label = "View chart as table",
                      help_text = (
                        dataTableOutput("table_sgo_ceased")
                      )
                    ),
                    details(
                      inputId = "sgo_info",
                      label = "Additional information:",
                      help_text = (
                        p(
                          "For more information on the data and definitions, please refer to the", a(href = "https://explore-education-statistics.service.gov.uk/find-statistics/children-looked-after-in-england-including-adoptions/data-guidance", "Children looked after in England including adoptions guidance."),
                          tags$br(),
                          "For more information on the methodology, please refer to the", a(href = "https://explore-education-statistics.service.gov.uk/methodology/children-looked-after-in-england-including-adoptions", "Children looked after in England including adoptions methodology.")
                      ))
                    )
                  ),
                  gov_row(
                    h2("Special Guardianship Order (SGO) by region"),
                    p("This is a static chart and will not react to geographical level and location selected in the filters at the top.

                      The chart represents data from 2023."),
                    br(),
                    plotlyOutput("plot_sgo_ceased_reg"),
                    br(),
                    details(
                      inputId = "tbl_sgo_ceased_cla_reg",
                      label = "View chart as table",
                      help_text = (
                        dataTableOutput("table_sgo_ceased_reg")
                      )
                    )
                  ),
                  gov_row(
                    h2("Special Guardianship Order (SGO) by local authority"),
                    p(sprintf("The charts below represent data from %s.", max(workforce_data$time_period))),
                    #                     p("This chart is reactive to the Local Authority and Regional filters at the top and will not react to the National filter. The chart will display all Local Authorities overall or every Local Authority in the selected Region.
                    #
                    # The graph represents data from 2023."),
                    # br(),
                    # plotlyOutput("plot_SGO_la"),
                    # br(),
                    # details(
                    #   inputId = "tbl_sgo_ceased_la",
                    #   label = "View chart as table",
                    #   help_text = (
                    #     dataTableOutput("table_sgo_la")
                    #   )
                    # ),
                    radioGroupButtons(
                      "sgo_stats_toggle",
                      label = NULL,
                      choices = c("All local authorities", "10 Statistical Neighbours"),
                      selected = "All local authorities"
                    ),
                    uiOutput("SN_sgo"),
                  )
                ),
                accordion_panel(
                  "Percentage of children who cease being looked after due to child Arrangement Order (CAO)",
                  gov_row(
                    h2("Residence order or Child Arrangement Order (CAO)"),
                    p("Unlocking family networks and kinship carers can be a key source of support where families are experiencing challenges.
                  Moving children from care arrangements to a SGO or CAO shows that kinship care is being prioritised where children cannot safely live with their parents."),
                    br(),
                    plotlyOutput("CAO_time_series"),
                    br(),
                    details(
                      inputId = "tbl_cao_ceased_cla",
                      label = "View chart as table",
                      help_text = (
                        dataTableOutput("table_cao_ceased")
                      )
                    ),
                  ),
                  gov_row(
                    h2("Residence order or Child Arrangement Order (CAO) by region"),
                    p("This is a static chart and will not react to geographical level and location selected in the filters at the top.

                      The chart represents data from 2023."),
                    br(),
                    plotlyOutput("plot_cao_ceased_reg"),
                    br(),
                    details(
                      inputId = "table_cao_ceased_reg",
                      label = "View chart as table",
                      help_text = (
                        dataTableOutput("table_cao_ceased_reg")
                      )
                    ),
                  ),
                  gov_row(
                    h2("Residence order or Child Arrangement Order (CAO) by local authority"),
                    p(sprintf("The charts below represent data from %s.", max(workforce_data$time_period))),

                    # br(),
                    # plotlyOutput("plot_cao_la"),
                    # br(),
                    # details(
                    #   inputId = "table_cao_la",
                    #   label = "View chart as table",
                    #   help_text = (
                    #     dataTableOutput("table_cao_la")
                    #   )
                    # ),
                    radioGroupButtons(
                      "cao_stats_toggle",
                      label = NULL,
                      choices = c("All local authorities", "10 Statistical Neighbours"),
                      selected = "All local authorities"
                    ),
                    uiOutput("SN_cao"),
                  )
                ),
                open = FALSE
              )
            )
          )
        )
      )
    )
  )
}
